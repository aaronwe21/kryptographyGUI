/*C3*/SET SCHEMA PUBLIC
DROP TABLE postbox_branch_hkg
DROP TABLE postbox_branch_cpt
DROP TABLE postbox_branch_sfo
DROP TABLE postbox_branch_syd
DROP TABLE postbox_branch_wuh
DROP TABLE postbox_msa
DROP TABLE messages
DROP TABLE channel
DROP TABLE participants
DROP TABLE algorithms
DROP TABLE types
CREATE TABLE algorithms ( id TINYINT NOT NULL,name VARCHAR(10) NOT NULL,PRIMARY KEY (id) )
CREATE UNIQUE INDEX idxAlgorithms ON algorithms (name)
CREATE TABLE types ( id TINYINT NOT NULL,name VARCHAR(10) NOT NULL,PRIMARY KEY (id) )
CREATE UNIQUE INDEX idxTypes ON types (name)
CREATE TABLE participants ( id TINYINT NOT NULL,name VARCHAR(50) NOT NULL,type_id TINYINT NOT NULL,PRIMARY KEY (id) )
CREATE UNIQUE INDEX idxParticipants ON participants (name)
ALTER TABLE participants ADD CONSTRAINT fkParticipants01 FOREIGN KEY (type_id) REFERENCES types (id) ON DELETE CASCADE
CREATE TABLE channel ( name VARCHAR(25) NOT NULL,participant_01 TINYINT NOT NULL,participant_02 TINYINT NOT NULL,PRIMARY KEY (name) )
ALTER TABLE channel ADD CONSTRAINT fkChannel01 FOREIGN KEY (participant_01) REFERENCES participants (id) ON DELETE CASCADE
ALTER TABLE channel ADD CONSTRAINT fkChannel02 FOREIGN KEY (participant_02) REFERENCES participants (id) ON DELETE CASCADE
CREATE TABLE messages ( id TINYINT NOT NULL,participant_from_id TINYINT NOT NULL,participant_to_id TINYINT NOT NULL,plain_message VARCHAR(50) NOT NULL,algorithm_id TINYINT NOT NULL,encrypted_message VARCHAR(50) NOT NULL,keyfile VARCHAR(20) NOT NULL,timestamp INTEGER,PRIMARY KEY (id) )
ALTER TABLE messages ADD CONSTRAINT fkMessages01 FOREIGN KEY (participant_from_id) REFERENCES participants (id) ON DELETE CASCADE
ALTER TABLE messages ADD CONSTRAINT fkMessages02 FOREIGN KEY (participant_to_id) REFERENCES participants (id) ON DELETE CASCADE
ALTER TABLE messages ADD CONSTRAINT fkMessages03 FOREIGN KEY (algorithm_id) REFERENCES algorithms (id) ON DELETE CASCADE
INSERT INTO ALGORITHMS VALUES(1,'shift')
COMMIT
INSERT INTO ALGORITHMS VALUES(2,'rsa')
COMMIT
INSERT INTO TYPES VALUES(1,'normal')
COMMIT
INSERT INTO TYPES VALUES(2,'intruder')
COMMIT
INSERT INTO PARTICIPANTS VALUES(1,'branch_hkg',1)
COMMIT
CREATE TABLE postbox_branch_hkg ( id TINYINT NOT NULL,participant_from_id TINYINT NOT NULL,message VARCHAR(50) NOT NULL,timestamp INTEGER,PRIMARY KEY (id) )
ALTER TABLE postbox_branch_hkg ADD CONSTRAINT fkPostboxbranch_hkg01 FOREIGN KEY (participant_from_id) REFERENCES participants (id) ON DELETE CASCADE
INSERT INTO PARTICIPANTS VALUES(2,'branch_cpt',1)
COMMIT
CREATE TABLE postbox_branch_cpt ( id TINYINT NOT NULL,participant_from_id TINYINT NOT NULL,message VARCHAR(50) NOT NULL,timestamp INTEGER,PRIMARY KEY (id) )
ALTER TABLE postbox_branch_cpt ADD CONSTRAINT fkPostboxbranch_cpt01 FOREIGN KEY (participant_from_id) REFERENCES participants (id) ON DELETE CASCADE
INSERT INTO PARTICIPANTS VALUES(3,'branch_sfo',1)
COMMIT
CREATE TABLE postbox_branch_sfo ( id TINYINT NOT NULL,participant_from_id TINYINT NOT NULL,message VARCHAR(50) NOT NULL,timestamp INTEGER,PRIMARY KEY (id) )
ALTER TABLE postbox_branch_sfo ADD CONSTRAINT fkPostboxbranch_sfo01 FOREIGN KEY (participant_from_id) REFERENCES participants (id) ON DELETE CASCADE
INSERT INTO PARTICIPANTS VALUES(4,'branch_syd',1)
COMMIT
CREATE TABLE postbox_branch_syd ( id TINYINT NOT NULL,participant_from_id TINYINT NOT NULL,message VARCHAR(50) NOT NULL,timestamp INTEGER,PRIMARY KEY (id) )
ALTER TABLE postbox_branch_syd ADD CONSTRAINT fkPostboxbranch_syd01 FOREIGN KEY (participant_from_id) REFERENCES participants (id) ON DELETE CASCADE
INSERT INTO PARTICIPANTS VALUES(5,'branch_wuh',1)
COMMIT
CREATE TABLE postbox_branch_wuh ( id TINYINT NOT NULL,participant_from_id TINYINT NOT NULL,message VARCHAR(50) NOT NULL,timestamp INTEGER,PRIMARY KEY (id) )
ALTER TABLE postbox_branch_wuh ADD CONSTRAINT fkPostboxbranch_wuh01 FOREIGN KEY (participant_from_id) REFERENCES participants (id) ON DELETE CASCADE
INSERT INTO PARTICIPANTS VALUES(6,'msa',2)
COMMIT
CREATE TABLE postbox_msa ( id TINYINT NOT NULL,participant_from_id TINYINT NOT NULL,message VARCHAR(50) NOT NULL,timestamp INTEGER,PRIMARY KEY (id) )
ALTER TABLE postbox_msa ADD CONSTRAINT fkPostboxmsa01 FOREIGN KEY (participant_from_id) REFERENCES participants (id) ON DELETE CASCADE
INSERT INTO CHANNEL VALUES('hkg_wuh',1,5)
COMMIT
INSERT INTO CHANNEL VALUES('hkg_cpt',1,2)
COMMIT
INSERT INTO CHANNEL VALUES('cpt_syd',2,4)
COMMIT
INSERT INTO CHANNEL VALUES('syd_sfo',4,3)
COMMIT
